var grsActiveCont,grsApp=angular.module("grsApp",[]);grsApp.service("GrsAdminService",["$window","$log","$sce",function(e,r,o){this.mode="pro",this.upgradeUrl=scriptData.grsUpgradeUrl,this.isPremium=scriptData.grsIsPremium,this.plan=scriptData.grsPlanName,this.uploaderUrl=scriptData.grsUploaderUrl,this.wpUploaderUrl=scriptData.grsWpUploaderUrl,this.pluginUrl=scriptData.grsPluginUrl,this.pluginVer=scriptData.grsPluginVer,this.imagesDir=this.pluginUrl+"/images/",this.getViewsTemplateUrl=function(e){return o.trustAsResourceUrl(this.pluginUrl+"/admin/views/"+e+".html?ver="+this.pluginVer)},this.canUsePremium=function(){return this.isPremium},this.isProPlan=function(){return"pro"===this.plan},this.isPersonalPlan=function(){return"personal"===this.plan},this.isElitePlan=function(){return"elite"===this.plan},this.isFreePlan=function(){return"free"===this.plan},this.setTooltip=function(){jQuery(".grsGallFCont").tooltip({position:{my:"center bottom-6",at:"center top",using:function(e,r){jQuery(this).css(e),jQuery("<div>").addClass("arrow").appendTo(this).addClass(r.vertical).addClass(r.horizontal)}},show:{effect:"fadeIn",duration:20},hide:{effect:"fadeOut",duration:20}})},this.getWPImageSizes=function(e){var r=parseInt(e.width),o=parseInt(e.height),t=e.wp_sizes;if(null===t)return{medium:300<r||300<o?this.getRightSizeUrlForWp(300,r,o):"",large:1024<r||1024<o?this.getRightSizeUrlForWp(1024,r,o):"",full:""};e.wp_sizes="object"!=typeof t?JSON.parse(t):t;e=void 0!==(t=e.wp_sizes).large?"-"+t.large.width+"x"+t.large.height:"";return{medium:void 0!==t.medium?"-"+t.medium.width+"x"+t.medium.height:e,large:e,full:""}},this.getRightSizeUrlForWp=function(e,r,o){return o<r?"-"+e+"x"+Math.round(e*o/r):"-"+Math.round(e*r/o)+"x"+e},this.getItemSrc=function(e){return this["itemSource_"+e.embed](e)},this.itemSource_=function(e){return this.uploaderUrl+e.path+"thumbnail/"+e.name+e.type},this.itemSource_wp=function(e){var r=this.getWPImageSizes(e);return this.wpUploaderUrl+e.path+e.name+r.medium+e.type},this.itemSource_instagram=function(e){return e.thumb_url},this.itemSource_youtube=function(e){return e.thumb_url},this.itemSource_vimeo=function(e){return e.thumb_url},this.itemSource_flickr=function(e){return e.thumb_url},this.log=function(e){"dev"==this.mode&&r.log(e)},this.getTrans=function(e){return void 0!==adminTransObj[e]?adminTransObj[e]:e}}]),grsApp.factory("GrsAdminFactory",["$http","$q","GrsAdminService",function(t,a,e){return{embedMedia:function(e,r,o){o={action:"grsGalleryAjax",grsAction:"embedMedia",grsAjaxNonce:scriptData.grsAjaxNonce,provider:e,url:r,gallery:o};return t({method:"POST",url:grsAdminAjax,data:jQuery.param(o),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){return a.resolve(e)},function(e){return GrsService.log("errr"),a.reject(e)})},saveGall:function(e,r){var o=0==e.id?"insert":"update",r={action:"grsGalleryAjax",grsAction:o,grsGallid:e.id,title:e.title,description:e.description,grsImages:JSON.stringify(r),grsAjaxNonce:scriptData.grsAjaxNonce};return t({method:"POST",url:grsAdminAjax,data:jQuery.param(r),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){return e.grsAction=o,a.resolve(e)},function(e){return GrsService.log("errr"),a.reject(e)})},saveOrder:function(e,r){r={action:"grsGalleryAjax",grsAction:"saveOrder",grsAjaxNonce:scriptData.grsAjaxNonce,gallery:e,items:r};return t({method:"POST",url:grsAdminAjax,data:jQuery.param(r),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){return a.resolve(e)},function(e){return GrsService.log("errr"),a.reject(e)})}}}]),grsApp.directive("toInt",function(){return{require:"ngModel",link:function(e,r,o,t){t.$parsers.push(function(e){return""+e}),t.$formatters.push(function(e){return parseInt(e)})}}}),grsApp.directive("validLink",["GrsAdminService",function(t){return{scope:{validLink:"="},link:function(e,r,o){e.link_=function(){return""==e.validLink.link?t.uploaderUrl+e.validLink.path+e.validLink.name+e.validLink.type:e.validLink.link},e.link_wp=function(){return""==e.validLink.link?t.wpUploaderUrl+e.validLink.path+e.validLink.name+e.validLink.type:e.validLink.link},e.link_youtube=function(){return""==e.validLink.link?e.validLink.path:e.validLink.link},e.link_instagram=function(){return e.link_youtube()},e.link_flickr=function(){return e.link_youtube()},e.link_vimeo=function(){return e.link_youtube()},e.validLink.link=e["link_"+e.validLink.embed]()}}}]),grsApp.directive("winclick",["$window",function(e){return{link:function(r){angular.element(e).on("click",function(e){r.$broadcast("winclick::winclick")})}}}]),grsApp.directive("draggable",["GrsAdminService",function(e){return{link:function(o,e){jQuery(e).sortable({start:function(e,r){e.stopPropagation(),o.oldPos=r.item.index(),r.item.addClass("forDrag")},stop:function(e,r){o.newPos=r.item.index(),r.item.removeClass("forDrag"),o.saveOrder(o.oldPos,o.newPos),o.$apply()},placeholder:"grsGallCoGaImC forDrop",delay:100,revert:400,tolerance:"pointer"}).disableSelection()}}}]),grsApp.controller("grsContent",["$scope","$filter","$log","$window","GrsAdminService",function(e,r,o,t,a){e.show=!1,e.showContPart="",e.grsSave=function(){void 0!==e["save"+e.showContPart]?e["save"+e.showContPart]():a.log("There is no method matching that name - save"+e.showContPart)}}]),grsApp.directive("extSrc",["GrsAdminService",function(e){return{restrict:"A",scope:!0,link:function(e,r,o){o=(o=o.extSrc).replace(/'/g,"\\'");r.attr("src",o)}}}]),grsApp.directive("grsPopup",["$filter","$http","$log","$timeout","GrsAdminService",function(e,a,r,o,n){return{restrict:"E",transclude:!0,scope:!1,templateUrl:n.getViewsTemplateUrl("grsPopup"),link:function(t,e,r){t.closePopup=function(){t.popupOptions.show=!1,t.popupOptions.showImg=!1,t.popupOptions.content={},t.popupOptions.comments=[]},t.isImage=function(){var e=t.popupOptions.content;return"video"!==e.type&&"link"!==e.type},t.isVideo=function(){return"video"===t.popupOptions.content.type},t.isLink=function(){return"link"===t.popupOptions.content.type},t.imgSrc=function(){var e=t.popupOptions.content;return""===e.embed?n.uploaderUrl+e.path+"/medium/"+e.name+e.type:"wp"===e.embed?n.wpUploaderUrl+e.path+e.name+n.getWPImageSizes(e).large+e.type:e.path},t.itemSrc=function(){return t.popupOptions.content.path},t.imgLoaded=function(e){t.popupOptions.showImg=!0},t.loadComments=function(e,r){a({method:"POST",url:grsAdminAjax,data:jQuery.param({action:"grsGalleryAjax",grsAction:"showComments",id:e,gallId:r}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){e=e.data;void 0===e.error&&(t.popupOptions.comments=e.success)},function(e){return GrsService.log("errr"),$q.reject(e)})},t.removeComments=function(r){var e,o=angular.element(jQuery(".grsGallHeader")).scope();o.grsLoading?o.wmassage():(e={action:"grsGalleryAjax",grsAction:"removeComments",id:t.popupOptions.comments[r].id},o.grsLoading=!0,a({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){o.grsLoading=!1;e=e.data;angular.isUndefined(e.error)&&t.popupOptions.comments.splice(r,1)},function(e){return GrsService.log("errr"),$q.reject(e)}))},t.getTrans=n.getTrans}}}]),grsApp.directive("imageOnload",function(){return{restrict:"A",link:function(e,r,o){r.bind("load",function(){e.$apply(o.imageOnload)})}}}),grsApp.directive("grsGalleries",["$filter","$http","$log","$timeout","GrsAdminService","GrsAdminFactory",function(o,l,e,i,g,a){return{restrict:"E",transclude:!0,scope:!1,templateUrl:g.getViewsTemplateUrl("grsGalleries"),link:function(p,e,r){p.filteredItems=[],p.groupedItems=[],p.pageSize=8,p.itemsPerPage=p.pageSize,p.pagedItems=[],p.currentPage=0,p.order="order",p.reverse=!1,p.selGall={},p.items=[],p.embed={show:!1,type:"",url:"",examples:{instagram:["https://www.instagram.com/p/BIvjQDKAp-F"],youtube:["https://www.youtube.com/watch?v=Zi0RpNSELas"],vimeo:["https://vimeo.com/9058605"],flickr:["https://www.flickr.com/photos/luc-mechelen/23071249392"]}},p.saveOrder=function(e,r){var o=p.pageSize*p.currentPage+e,t=p.pageSize*p.currentPage+r,a=[];if(t<o)angular.forEach(p.items,function(e,r){t<=r&&r<o?e.order=r+1:r==o?(e.select=!1,e.order=t):e.order=r,a.push({id:e.id,order:e.order})}),p.itemsOrderToChange=a;else{if(!(o<t))return;angular.forEach(p.items,function(e,r){o<r&&r<=t?e.order=r-1:r==o?(e.select=!1,e.order=t):e.order=r,a.push({id:e.id,order:e.order})}),p.itemsOrderToChange=a}p.orderBy("order")},p.saveOrderDB=function(e){var r=angular.element(jQuery(".grsGallHeader")).scope();r.grsLoading?r.wmassage():(r.grsLoading=!0,a.saveOrder(p.selGall.id,e).then(function(e){r.grsLoading=!1,void 0===e.data.error?(r.grsMassage=p.getTrans("text_041"),r.grsMassageMood="success"):(r.grsMassage=e.data.error,r.grsMassageMood="error"),r.massage()},function(e){g.log(e)}))},p.getMinOrder=function(){return 0<p.items.length?Math.min.apply(Math,p.items.map(function(e){return e.order})):1},p.popupOptions={show:!1,content:{}},p.showPopup=function(e,r){r.stopPropagation(),r.preventDefault(),angular.element(jQuery(".grsGallHeader")).scope().showGTs=!1,p.popupOptions.show=!0,p.popupOptions.content=p.pagedItems[p.currentPage][e],p.loadComments(p.pagedItems[p.currentPage][e].id,p.selGall.id)},p.getItemSrc=function(e){e=p.pagedItems[p.currentPage][e];return g.getItemSrc(e)},p.getGallItems=function(){var r=angular.element(jQuery(".grsGallHeader")).scope(),e={action:"grsGalleryAjax",grsAction:"getGalleryItems",grsAjaxNonce:scriptData.grsAjaxNonce};r.grsLoading=!0,l({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){r.grsLoading=!1;e=e.data;r.galleriesDataIsLoaded=!0,p.$$phase||p.$apply(),angular.isUndefined(e.error)?(e=e.success,e=o("filter")(e,function(e){return e.id=parseInt(e.id),!0}),p.galleriesData=o("orderBy")(e,"id",!0)):(r.grsMassage="text_074",r.grsMassageMood="error",r.massage())},function(e){return g.log("errr"),r.grsLoading=!1,r.grsMassage="text_074",r.grsMassageMood="error",r.massage(!1),$q.reject(e)})},p.getGallItems(),String.prototype.trunc=String.prototype.trunc||function(e){return this.length>e?this.substr(0,e-1)+" ...":this.toString()},p.changeGallery=function(e,r){if(g.log("gallery (to change id)"),g.log(e),g.log(r),0==e)return p.selGall={id:0,title:"",description:"",pvIm:g.imagesDir+"thumbnail/grsnopv.png",imagesCount:0,images:[],prevImgPath:"",prevImgName:"grsnopv",prevImgType:".png"},p.items=[],void p.search();if(0==p.selGall.id&&(p.selGall.id=e,p.selGall.title=r,p.galleriesData.splice(0,0,p.selGall),p.galleriesData=angular.copy(p.galleriesData)),!angular.isUndefined(p.galleriesData)){for(var o=0;o<p.galleriesData.length;o++)if(p.galleriesData[o].id==e){p.selGall=p.galleriesData[o],p.selGall.pvIm=("grsnopv"===p.selGall.prevImgName?g.imagesDir:g.uploaderUrl)+p.selGall.prevImgPath+"thumbnail/"+p.selGall.prevImgName+p.selGall.prevImgType,p.items=p.selGall.images,angular.isUndefined(p.itemsOrderToChange)||delete p.itemsOrderToChange;break}p.search()}},p.saveGall=function(){var o=angular.element(jQuery(".grsGallHeader")).scope();o.grsLoading?o.wmassage():(o.grsLoading=!0,a.saveGall(p.selGall,p.pagedItems[p.currentPage]).then(function(e){var r;o.grsLoading=!1,void 0===e.data.error?(r=e.data.success,"insert"===e.grsAction?(p.changeGallery(r.id,r.title),o.addItem(r.title,"",r.id)):(p.selGall.title=r.title,o.updateItem(r.title),p.updateAlbsContents(r.id,r.title,"gal")),p.galleriesData=angular.copy(p.galleriesData),o.grsMassage=p.getTrans("text_042"),o.grsMassageMood="success",void 0!==p.itemsOrderToChange&&(p.saveOrderDB(p.itemsOrderToChange),delete p.itemsOrderToChange)):(o.grsMassage=""==e.data.error?p.getTrans("text_043"):e.data.error,o.grsMassageMood="error"),o.massage()},function(e){g.log(e)}))},p.enableWPMedia=function(){p.addImagesFromWPMedia=wp.media.frames.file_frame=wp.media({title:"Add image to gallery",button:{text:"Add"},multiple:"add",toolbar:"select",library:{type:"image"}}),p.addImagesFromWPMedia.on("select",function(){var e=p.addImagesFromWPMedia.state().get("selection"),r=[];e.map(function(e){r.push(e.toJSON())}),p.callbackForWPMediaAddImages(r)})},p.enableWPMedia(),p.callbackForWPMediaAddImages=function(e){var n,i,s,t=angular.element(jQuery(".grsGallHeader")).scope();t.grsLoading?t.wmassage():(g.log(e),n=p.getMinOrder(),i=p.selGall.imagesCount?parseInt(p.selGall.imagesCount):0,s=[],angular.forEach(e,function(e){i++,n--,g.log(e);var r=e.filename.split("."),o="."+r.pop(),t=e.url.split(g.wpUploaderUrl)[1].split(e.filename),a=p.getWpImageSizesJSON(e.sizes,e.width,e.height);r.splice(r.length);a={name:r.join("."),title:e.title,description:e.description,path:t[0],type:o,order:n,key:i,width:e.width,height:e.height,wp_sizes:a};g.log(a),s.push(a)}),g.log(s),p.selGall.imagesCount=i,e={action:"grsGalleryAjax",grsAction:"addImagesFromWP",grsId:p.selGall.id,files:s,grsAjaxNonce:scriptData.grsAjaxNonce},t.grsLoading=!0,l({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){g.log(e);e=e.data;if(t.grsLoading=!1,"success"===Object.keys(e)[0]){t.grsMassage=p.getTrans("text_044");for(var r=e.success,o=0;o<s.length;o++)g.log("id - "+r[o]),p.addItem(s[o].name,s[o].title,s[o].description,s[o].path,"",n,s[o].type,"wp","",s[o].key,r[o],s[o].width,s[o].height,s[o].wp_sizes);t.grsMassageMood="success"}else t.grsMassage=e.error,t.grsMassageMood="error";t.massage()},function(e){return g.log("errr"),$q.reject(e)}))},p.getWpImageSizesJSON=function(o,e,r){var t={};function a(e){t[e]={};var r=o[e].url.split("-").pop().split(".")[0].split("x");t[e].width=r[0],t[e].height=r[1]}return t.full={width:e,height:r},angular.isUndefined(o.thumbnail)||a("thumbnail"),angular.isUndefined(o.medium)||a("medium"),angular.isUndefined(o.large)||a("large"),t},p.addImagesFromWP=function(){p.addImagesFromWPMedia.open()},p.addImages=function(){var e=angular.element(jQuery(".grsGallUpl")).scope(),r=angular.element(jQuery(".grsGallHeader")).scope();e.options.show||r.selectTab("Upl"),e.options.addImages||(e.options.addAction="addImages",e.options.addImages=!0,e.options.addImageTitle="Add")},p.addGPvIm=function(e,r,o){p.selGall.prevImgName=r,p.selGall.prevImgPath=e,p.selGall.prevImgType=o,p.selGall.pvIm=g.uploaderUrl+e+"thumbnail/"+r+o,p.selGall.hidePvIm=!0},p.activeGPw=function(){var e=angular.element(jQuery(".grsGallUpl")).scope(),r=angular.element(jQuery(".grsGallHeader")).scope();e.options.show||r.selectTab("Upl"),e.options.addImages&&(e.options.addAction="addGPvIm",e.options.addImages=!1,e.options.addImageTitle=p.getTrans("text_045"))},p.deleteGallery=function(e,r){void 0!==r&&r.stopPropagation();for(var o=0;o<p.galleriesData.length;o++)p.galleriesData[o].id==e&&(p.galleriesData.splice(o,1),p.galleriesData=angular.copy(p.galleriesData),p.selGall.id==e&&(p.selGall={id:"",title:"",description:"",pvIm:g.imagesDir+"thumbnail/grsnopv.png",imagesCount:0,images:[],prevImgPath:"",prevImgName:"grsnopv",prevImgType:".png"},p.items=[],p.search()));p.delAlbsContsFromPrnt(e,"gal")},p.addItem=function(e,r,o,t,a,n,i,s,l,g,c,u,d,m){p.pageSize++,p.itemsPerPage=p.pageSize,p.firstPage(),p.items.splice(0,0,{name:e,title:r,description:o,path:t,link:a,order:n,type:i,embed:s,thumb_url:l,publish:1,key:g,id:c=c||g,hide:""===s,width:u,height:d,wp_sizes:m}),p.search()},p.addIdsToScopes=function(e,r){for(var o=0;o<e.length;o++)for(var t=p.pagedItems[p.currentPage].length-1;0<=t;t--)p.pagedItems[p.currentPage][t].key===e[o]&&(p.pagedItems[p.currentPage][t].id=r[o])},p.grsDeleteGImgPr=function(e,r){void 0!==e&&(e.preventDefault(),e.stopPropagation());var o=angular.element(jQuery(".grsGallConfirmMC")).scope(),t=jQuery(e.target).offset().left-jQuery(".grsGallFCont").offset().left,a=jQuery(e.target).offset().top-jQuery(".grsGallFCont").offset().top;o.options.left=t,o.options.top=25+a,o.options.actCnt=".grsGallContent","grsGallCoGaImDatAcDb"==e.target.className?(o.options.grsConMess=p.getTrans("text_046"),o.options.grsConIt=p.pagedItems[p.currentPage][r].title,o.options.grsConTp=p.getTrans("text_047"),o.options.actF="deleteImage",o.options.actP.push(r)):(o.options.grsConMess=p.getTrans("text_010"),o.options.grsConIt="",o.options.grsConTp="",o.options.actF="deleteItems",o.options.actP.push("")),o.options.show=!0},p.deleteImage=function(r){var e,o,t=angular.element(jQuery(".grsGallHeader")).scope();t.grsLoading?t.wmassage():(e=p.pagedItems[p.currentPage][r].id,o=p.itemsPerPage*p.currentPage+parseInt(r),grsAction="deleteImage",data={action:"grsGalleryAjax",grsAction:grsAction,id:e,grsAjaxNonce:scriptData.grsAjaxNonce},t.grsLoading=!0,l({method:"POST",url:grsAdminAjax,data:jQuery.param(data),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){t.grsLoading=!1;e=e.data;void 0===e.error?(p.pagedItems[p.currentPage][r].delete=!0,i(function(){p.items.splice(o,1),p.search()},500),t.grsMassage=p.getTrans("text_048"),t.grsMassageMood="success"):(t.grsMassage=""==e.error?p.getTrans("text_043"):e.error,t.grsMassageMood="error"),t.massage()},function(e){return g.log("errr"),$q.reject(e)}))},p.deleteItems=function(){var o=angular.element(jQuery(".grsGallHeader")).scope();if(o.grsLoading)o.wmassage();else{for(var e=p.pagedItems[p.currentPage],t=[],a=[],r=0;r<e.length;r++)e[r].select&&(p.itemsPerPage,p.currentPage,parseInt(r),t.push(e[r].id),a.push(e[r]));var n={action:"grsGalleryAjax",grsAction:"deleteImages",ids:t,grsAjaxNonce:scriptData.grsAjaxNonce};o.grsLoading=!0,l({method:"POST",url:grsAdminAjax,data:jQuery.param(n),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){o.grsLoading=!1;e=e.data;if(void 0===e.error){for(var r=0;r<a.length;r++)a[r].delete=!0;i(function(){for(var e=0;e<p.items.length;e++)for(var r=0;r<t.length;r++)p.items[e].id==t[r]&&p.items.splice(e,1);p.search()},500),o.grsMassage=p.getTrans("text_048"),o.grsMassageMood="success"}else o.grsMassage=""==e.error?p.getTrans("text_043"):e.error,o.grsMassageMood="error";o.massage()},function(e){return g.log("errr"),$q.reject(e)})}},p.selectItem=function(e){p.pagedItems[p.currentPage][e].select=!p.pagedItems[p.currentPage][e].select},p.selectItems=function(e){e.preventDefault();var r=p.pagedItems[p.currentPage],o=!1;if(void 0!==r){for(var t=0;t<r.length;t++)if(void 0===r[t].select||!r[t].select){o=!0;break}for(t=0;t<r.length;t++)r[t].select=o}},p.showItemInfo=function(e,r){r.stopPropagation(),p.pagedItems[p.currentPage][e].info=!p.pagedItems[p.currentPage][e].info},p.shEmCont=function(){return p.embed.show},p.showEmbedMedia=function(e){p.embed.show=!0,p.embed.type=e},p.closeEmbedMedia=function(){var e=p.embed;e.show=!1,e.type="",e.url=""},p.addEmbedMedia=function(){var o=p.embed,e=o.url,r=o.type,t=angular.element(jQuery(".grsGallHeader")).scope();if(""===e)return t.grsMassage=p.getTrans("text_050"),t.grsMassageMood="error",void t.massage();t.grsLoading=!0,a.embedMedia(r,e,p.selGall.id).then(function(e){var r;t.grsLoading=!1,g.log(e),angular.isUndefined(e.data.error)?(r=e.data.success,p.addItem("",r.title,r.description,r.path,r.link,r.order,r.type,r.embed,r.thumb_url,r.id,null),t.grsMassage=p.getTrans("text_049"),t.grsMassageMood="success",p.closeEmbedMedia()):(o.url="",t.grsMassage=e.data.error,t.grsMassageMood="error"),t.massage()},function(e){g.log(e)})},p.orderBy=function(e,r){void 0!==r?(r.preventDefault(),p.reverse=e==p.order&&!p.reverse):p.reverse=!1,p.order=e,p.items=o("orderBy")(p.items,p.order,p.reverse),p.search(!0)},p.changeItemsPerPage=function(){p.pageSize=void 0===p.pageSize||null==p.pageSize?1:p.pageSize,p.itemsPerPage=p.pageSize,p.search()};p.search=function(e){p.filteredItems=o("filter")(p.items,function(e){for(var r in e)if(e.id=parseInt(e.id),e.order=parseInt(e.order),"title"==r&&(o=e[r],!(r=p.query)||-1!==o.toLowerCase().indexOf(r.toLowerCase())))return!0;var o;return!1}),e||(p.currentPage=0),p.groupToPages()},p.groupToPages=function(){p.pagedItems=[];for(var e=0;e<p.filteredItems.length;e++)e%p.itemsPerPage==0?p.pagedItems[Math.floor(e/p.itemsPerPage)]=[p.filteredItems[e]]:p.pagedItems[Math.floor(e/p.itemsPerPage)].push(p.filteredItems[e])},p.range=function(e,r){var o=[];r||(r=e,e=0);for(var t=e;t<r;t++)o.push(t);return o},p.prevPage=function(){0<p.currentPage&&p.currentPage--},p.nextPage=function(){p.currentPage<p.pagedItems.length-1&&p.currentPage++},p.lastPage=function(){p.currentPage<p.pagedItems.length-1&&(p.currentPage=p.pagedItems.length-1)},p.firstPage=function(){0<p.currentPage&&(p.currentPage=0)},p.setPage=function(){p.currentPage=this.n},p.getTrans=g.getTrans}}}]),grsApp.directive("grsThemes",["$filter","$http","$timeout","GrsAdminService",function(e,n,r,i){return{restrict:"E",transclude:!0,scope:!1,template:'<div onload="themeContLoaded()" ng-include="options.themeUrl"></div>',link:function(a,r,e){a.pluginUrl=i.pluginUrl,a.grsSelectedTheme={thumbnail:{},film:{},carousel3d:{},masonry:{},mosaic:{},navigation:{},lightbox:{}},a.options={themeUrl:i.getViewsTemplateUrl("grsThemes"),view:"Thumbnail",lightboxMain:!1,lightboxCloseButton:!1,lightboxTitle:!1,lightboxTitleCont:!1,lightboxOnlyDesc:!1,lightboxOnlyTitle:!1,lightboxImageCo:!1,lightboxNav:!1,lightboxFilm:!1,lightboxFilmCont:!1,lightboxFilmNav:!1,lightboxContButt:!1,lightboxContButtCont:!1,lightboxContButtButts:!1,lightboxComm:!1,lightboxCommCont:!1,lightboxCommLabels:!1,lightboxCommInp:!1,lightboxCommCButt:!1,lightboxCommCpButt:!1,lightboxCommAuth:!1,lightboxCommText:!1,lightboxCommDate:!1,thumbnailImg:!1,thumbnailTitle:!1,masonryImg:!1,masonryTitle:!1,mosaicImg:!1,mosaicTitle:!1,navMainCont:!1,navButtons:!1,navBackButton:!1,navIconsHide:!0,filmNavIconsHide:!0,contIconsHide:!0,fmNavIcons:!1,fmNavIconsHide:!0},a.showHideParts=function(e){a.options[e]=!a.options[e]},a.showNavButtsV=[{value:"no",name:"No",class:"noneOp"},{value:"onhover",name:"On hover",class:""},{value:"always",name:"Always",class:""}],a.nBEffects=[{value:"no",name:"No effect",class:"noneOp"},{value:"fade",name:"Fade",class:""},{value:"slideIn",name:"Slide In",class:""},{value:"rotateIn",name:"Rotate In",class:""}],a.navButtShButtsCh=function(){a.grsSelectedTheme.showNavBuutEff="onhover"===a.grsSelectedTheme.lightbox.navButtShButts},a.navButtShButtsCh=function(){a.grsSelectedTheme.showNavBuutEff="onhover"===a.grsSelectedTheme.lightbox.navButtShButts},a.ftSEffects=[{value:"no",name:"No effect",class:"noneOp"},{value:"fadeIn",name:"Fade In",class:""},{value:"fadeOut",name:"Fade Out",class:""},{value:"zoom",name:"Zoom",class:""},{value:"rotate",name:"Rotate",class:""},{value:"border",name:"Border",class:""}],a.hoverEffects=[{value:"none",name:"None",class:"noneOp"},{value:"scaleIm",name:"Zoom(image)",class:""},{value:"scaleRotIm",name:"Zoom + rotate(image)",class:""},{value:"scaleTransIm",name:"Zoom + translate(image)",class:""},{value:"scale",name:"Zoom",class:""},{value:"rotate",name:"Rotate",class:""},{value:"grayscale",name:"Gray",class:""},{value:"sepia",name:"Sepia",class:""},{value:"flash",name:"Flash",class:""},{value:"blur",name:"Blur + grayscale",class:""},{value:"shine",name:"Shine",class:""},{value:"circle",name:"Circle",class:""}],a.borderStyles=[{value:"none",name:"None"},{value:"hidden",name:"Hidden"},{value:"dotted",name:"Dotted"},{value:"dashed",name:"Dashed"},{value:"solid",name:"Solid"},{value:"double",name:"Double"},{value:"groove",name:"Groove"},{value:"ridge",name:"Ridge"},{value:"inset",name:"Inset"},{value:"outset",name:"Outset"},{value:"initial",name:"Initial"}],a.fontFamilies=[{value:"cursive",name:"Cursive",class:""},{value:"fantasy",name:"Fantasy",class:""},{value:"inherit",name:"Inherit",class:""},{value:"monospace",name:"Monospace",class:""},{value:"sans-serif",name:"Sans-serif",class:""},{value:"serif",name:"Serif",class:""},{value:"Georgia",name:"Georgia",class:""},{value:"Architex",name:"Architex",class:""},{value:"Peterbuilt",name:"Peterbuilt",class:""},{value:"Max",name:"Max",class:""},{value:"WIREDsaji",name:"WIREDsaji",class:""},{value:"CoventryGardenNF",name:"CoventryGardenNF",class:""},{value:"Femkeklaver",name:"Femkeklaver",class:""},{value:"Caeldera",name:"Caeldera",class:""}],a.fontWeights=[{value:"100",name:"100",class:""},{value:"200",name:"200",class:""},{value:"300",name:"300",class:""},{value:"400",name:"400",class:""},{value:"500",name:"500",class:""},{value:"600",name:"600",class:""},{value:"700",name:"700",class:""},{value:"800",name:"800",class:""},{value:"900",name:"900",class:""},{value:"bold",name:"Bold",class:""},{value:"bolder",name:"Bolder",class:""},{value:"inherit",name:"Inherit",class:""},{value:"initial",name:"Initial",class:""},{value:"lighter",name:"Lighter",class:""},{value:"normal",name:"Normal",class:""}],a.fontStyles=[{value:"italic",name:"Italic",class:""},{value:"inherit",name:"Inherit",class:""},{value:"normal",name:"Normal",class:""},{value:"oblique",name:"Oblique",class:""}],a.tPoss=[{value:"top",name:"Top",class:""},{value:"middle",name:"Middle",class:""},{value:"bottom",name:"Bottom",class:""}],a.align=[{value:"left",name:"Left",class:""},{value:"center",name:"Center",class:""},{value:"right",name:"Right",class:""}],a.tEffects=[{value:"no",name:"No effect",class:"noneOp"},{value:"grsFadeIn",name:"Fade in",class:""},{value:"grsSlideInLeft",name:"Slide in left",class:""},{value:"grsSlideInRight",name:"Slide in right",class:""},{value:"grsSlideInUp",name:"Slide in up",class:""},{value:"grsSlideInDown",name:"Slide in down",class:""},{value:"grsZoomIn",name:"Zoom In",class:""},{value:"grsTransUp",name:"Translate up",class:""},{value:"grsRotateX",name:"Rotate x",class:""},{value:"grsRotateY",name:"Rotate y",class:""},{value:"grsBounceIn",name:"Bounce in",class:""},{value:"grsBounceInDown",name:"Bounce in down",class:""},{value:"grsBounceInLeft",name:"Bounce in left",class:""},{value:"grsFlipInX",name:"Flip in x",class:""},{value:"grsFlipInY",name:"Flip in y",class:""},{value:"grsRollIn",name:"Roll in",class:""},{value:"mask",name:"Mask",class:""}],a.contButtOnhovers=[{value:"0",name:"Active"},{value:"1",name:"Passvie"},{value:"2",name:"Same"}],a.gradientDirections=[{value:"180deg",name:"From top to bottom"},{value:"0deg",name:"From bottom to top"},{value:"90deg",name:"From left to right"},{value:"-90deg",name:"From right to left"}],a.positionTypes=[{value:"topRight",name:"Top right"},{value:"topCenter",name:"Top center"},{value:"topLeft",name:"Top left"},{value:"bottomLeft",name:"Bottom left"},{value:"bottomCenter",name:"Bottom center"},{value:"bottomRight",name:"Bottom right"},{value:"center",name:"Center"}],a.getThemeItems=function(){var t=angular.element(jQuery(".grsGallHeader")).scope(),e={action:"grsGalleryAjax",grsAction:"getThemeItems",grsAjaxNonce:scriptData.grsAjaxNonce};t.grsLoading=!0,n({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){t.grsLoading=!1;var r=e.data;if(i.log(e),void 0===r.error){a.grsThemes=r.success.grsThemes,a.newTheme=r.success.newTheme;for(var o=0;o<a.grsThemes.length;o++)if(1==a.grsThemes[o].default){a.grsChangeTheme(o);break}}else t.grsMassage=""==r.error?a.getTrans("text_051"):r.error,t.grsMassageMood="error",t.massage()},function(e){return i.log("errr"),t.grsLoading=!1,t.grsMassage=a.getTrans("text_051"),t.grsMassageMood="error",t.massage(!1),$q.reject(e)})},a.getThemeItems(),a.themeContLoaded=function(){r.find(".thumbnailTBgcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".thumbnailTcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".thumbnailMaskColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".thumbnailBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".thumbnailBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".thumbnailBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmThumbBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmThumbBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmThumbBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmNavBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmNavHoverBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmNavColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmNavHoverColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmNavBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmNavBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmTBgcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmTcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".crs3dBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".crs3dThumbBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".crs3dThumbBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".crs3dThumbBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".crs3dTBgcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".crs3dTcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".masonryBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".masonryBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".masonryBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".masonryTBgcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".masonryTcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".mosaicBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".mosaicBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".mosaicBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".mosaicTBgcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".mosaicTcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".bgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".boxBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".closeButtBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".closeButtColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".closeButtHoverColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".closeButtBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".closeButtBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".titleDescpBgGrFrColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".titleDescpBgGrToColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".titleDescpTColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".titleDescpDColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".titleDescpshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".imgcoBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".imgcoColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".imgcoshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".navButtBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".navButtColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".navButtHoverColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".navButtBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".navButtShadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".navButtHoverShadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".navButtBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmstripBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmThumbBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmThumbBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmSelThumbBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmThumbBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmNavBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmNavHoverBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmNavButtColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmNavButtHoverColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmNavBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmNavBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtContBgGrFrColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtContBgGrToColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtContBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtHoverBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtHoverColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtShadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtContBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commContBgcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commFontColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commButtBgcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commButtHBgcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commButtBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commInpColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commInpBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commInpBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commInpBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commInpAcBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commInpAcBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commButtColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commButtBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commClButtBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commClButtHoverColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commClButtColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commClButtBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commClButtBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commCpButtBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commCpButtBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commCpButtColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commCpButtHoverColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commCpButtBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commAFontColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commTFontColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commDFontColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".pnavBBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".pnavBBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".pnavBBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".pnavBHBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".pnavBABgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".pnavBcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".backBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".backBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".backHBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".backColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".backBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")})},a.grsChangeTheme=function(e){a.grsSelectedTheme=a.grsThemes[e],a.navButtShButtsCh(),r.find(".thumbnailTBgcolor").colorpicker("setValue",a.grsSelectedTheme.thumbnail.thumbnailTBgcolor),r.find(".thumbnailTcolor").colorpicker("setValue",a.grsSelectedTheme.thumbnail.thumbnailTcolor),r.find(".thumbnailMaskColor").colorpicker("setValue",a.grsSelectedTheme.thumbnail.thumbnailMaskColor),r.find(".thumbnailBorderColor").colorpicker("setValue",a.grsSelectedTheme.thumbnail.thumbnailBorderColor),r.find(".thumbnailBoxshadowColor").colorpicker("setValue",a.grsSelectedTheme.thumbnail.thumbnailBoxshadowColor),r.find(".thumbnailBgColor").colorpicker("setValue",a.grsSelectedTheme.thumbnail.thumbnailBgColor),r.find(".masonryBorderColor").colorpicker("setValue",a.grsSelectedTheme.masonry.masonryBorderColor),r.find(".masonryBoxshadowColor").colorpicker("setValue",a.grsSelectedTheme.masonry.masonryBoxshadowColor),r.find(".masonryBgColor").colorpicker("setValue",a.grsSelectedTheme.masonry.masonryBgColor),r.find(".masonryTBgcolor").colorpicker("setValue",a.grsSelectedTheme.masonry.masonryTBgcolor),r.find(".masonryTcolor").colorpicker("setValue",a.grsSelectedTheme.masonry.masonryTcolor),r.find(".fmBgColor").colorpicker("setValue",a.grsSelectedTheme.film.fmBgColor),r.find(".fmThumbBorderColor").colorpicker("setValue",a.grsSelectedTheme.film.fmThumbBorderColor),r.find(".fmThumbBoxshadowColor").colorpicker("setValue",a.grsSelectedTheme.film.fmThumbBoxshadowColor),r.find(".fmThumbBgColor").colorpicker("setValue",a.grsSelectedTheme.film.fmThumbBgColor),r.find(".fmNavBgColor").colorpicker("setValue",a.grsSelectedTheme.film.fmNavBgColor),r.find(".fmNavHoverBgColor").colorpicker("setValue",a.grsSelectedTheme.film.fmNavHoverBgColor),r.find(".fmNavColor").colorpicker("setValue",a.grsSelectedTheme.film.fmNavColor),r.find(".fmNavHoverColor").colorpicker("setValue",a.grsSelectedTheme.film.fmNavHoverColor),r.find(".fmNavBoxshadowColor").colorpicker("setValue",a.grsSelectedTheme.film.fmNavBoxshadowColor),r.find(".fmNavBorderColor").colorpicker("setValue",a.grsSelectedTheme.film.fmNavBorderColor),r.find(".fmTBgcolor").colorpicker("setValue",a.grsSelectedTheme.film.fmTBgcolor),r.find(".fmTcolor").colorpicker("setValue",a.grsSelectedTheme.film.fmTcolor),r.find(".crs3dBgColor").colorpicker("setValue",a.grsSelectedTheme.carousel3d.crs3dBgColor),r.find(".crs3dThumbBorderColor").colorpicker("setValue",a.grsSelectedTheme.carousel3d.crs3dThumbBorderColor),r.find(".crs3dThumbBoxshadowColor").colorpicker("setValue",a.grsSelectedTheme.carousel3d.crs3dThumbBoxshadowColor),r.find(".crs3dThumbBgColor").colorpicker("setValue",a.grsSelectedTheme.carousel3d.crs3dThumbBgColor),r.find(".crs3dTBgcolor").colorpicker("setValue",a.grsSelectedTheme.carousel3d.crs3dTBgcolor),r.find(".crs3dTcolor").colorpicker("setValue",a.grsSelectedTheme.carousel3d.crs3dTcolor),r.find(".mosaicBorderColor").colorpicker("setValue",a.grsSelectedTheme.mosaic.mosaicBorderColor),r.find(".mosaicBoxshadowColor").colorpicker("setValue",a.grsSelectedTheme.mosaic.mosaicBoxshadowColor),r.find(".mosaicBgColor").colorpicker("setValue",a.grsSelectedTheme.mosaic.mosaicBgColor),r.find(".mosaicTBgcolor").colorpicker("setValue",a.grsSelectedTheme.mosaic.mosaicTBgcolor),r.find(".mosaicTcolor").colorpicker("setValue",a.grsSelectedTheme.mosaic.mosaicTcolor),r.find(".pnavBBorderColor").colorpicker("setValue",a.grsSelectedTheme.navigation.pnavBBorderColor),r.find(".pnavBBoxshadowColor").colorpicker("setValue",a.grsSelectedTheme.navigation.pnavBBoxshadowColor),r.find(".pnavBBgColor").colorpicker("setValue",a.grsSelectedTheme.navigation.pnavBBgColor),r.find(".pnavBHBgColor").colorpicker("setValue",a.grsSelectedTheme.navigation.pnavBHBgColor),r.find(".pnavBABgColor").colorpicker("setValue",a.grsSelectedTheme.navigation.pnavBABgColor),r.find(".pnavBcolor").colorpicker("setValue",a.grsSelectedTheme.navigation.pnavBcolor),r.find(".backBoxshadowColor").colorpicker("setValue",a.grsSelectedTheme.navigation.backBoxshadowColor),r.find(".backBgColor").colorpicker("setValue",a.grsSelectedTheme.navigation.backBgColor),r.find(".backHBgColor").colorpicker("setValue",a.grsSelectedTheme.navigation.backHBgColor),r.find(".backColor").colorpicker("setValue",a.grsSelectedTheme.navigation.backColor),r.find(".backBorderColor").colorpicker("setValue",a.grsSelectedTheme.navigation.backBorderColor),r.find(".bgColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.bgColor),r.find(".boxBgColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.boxBgColor),r.find(".closeButtBgColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.closeButtBgColor),r.find(".closeButtColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.closeButtColor),r.find(".closeButtHoverColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.closeButtHoverColor),r.find(".closeButtBoxshadowColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.closeButtBoxshadowColor),r.find(".closeButtBorderColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.closeButtBorderColor),r.find(".titleDescpBgGrFrColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.titleDescpBgGrFrColor),r.find(".titleDescpBgGrToColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.titleDescpBgGrToColor),r.find(".titleDescpTColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.titleDescpTColor),r.find(".titleDescpDColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.titleDescpDColor),r.find(".titleDescpshadowColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.titleDescpshadowColor),r.find(".imgcoBgColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.imgcoBgColor),r.find(".imgcoColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.imgcoColor),r.find(".imgcoshadowColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.imgcoshadowColor),r.find(".navButtColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.navButtColor),r.find(".navButtHoverColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.navButtHoverColor),r.find(".navButtBgColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.navButtBgColor),r.find(".navButtBoxshadowColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.navButtBoxshadowColor),r.find(".navButtShadowColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.navButtShadowColor),r.find(".navButtHoverShadowColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.navButtHoverShadowColor),r.find(".navButtBorderColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.navButtBorderColor),r.find(".filmstripBgColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.filmstripBgColor),r.find(".filmThumbBorderColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.filmThumbBorderColor),r.find(".filmThumbBoxshadowColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.filmThumbBoxshadowColor),r.find(".filmSelThumbBorderColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.filmSelThumbBorderColor),r.find(".filmThumbBgColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.filmThumbBgColor),r.find(".filmNavBgColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.filmNavBgColor),r.find(".filmNavHoverBgColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.filmNavHoverBgColor),r.find(".filmNavButtColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.filmNavButtColor),r.find(".filmNavButtHoverColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.filmNavButtHoverColor),r.find(".filmNavBoxshadowColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.filmNavBoxshadowColor),r.find(".filmNavBorderColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.filmNavBorderColor),r.find(".contButtContBgGrFrColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.contButtContBgGrFrColor),r.find(".contButtContBgGrToColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.contButtContBgGrToColor),r.find(".contButtContBoxshadowColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.contButtContBoxshadowColor),r.find(".contButtBgColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.contButtBgColor),r.find(".contButtHoverBgColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.contButtHoverBgColor),r.find(".contButtColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.contButtColor),r.find(".contButtHoverColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.contButtHoverColor),r.find(".contButtBoxshadowColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.contButtBoxshadowColor),r.find(".contButtShadowColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.contButtShadowColor),r.find(".contButtBorderColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.contButtBorderColor),r.find(".contButtContBorderColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.contButtContBorderColor),r.find(".commContBgcolor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commContBgcolor),r.find(".commFontColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commFontColor),r.find(".commButtBgcolor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commButtBgcolor),r.find(".commButtHBgcolor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commButtHBgcolor),r.find(".commButtBoxshadowColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commButtBoxshadowColor),r.find(".commInpColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commInpColor),r.find(".commInpBoxshadowColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commInpBoxshadowColor),r.find(".commInpBorderColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commInpBorderColor),r.find(".commInpBgColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commInpBgColor),r.find(".commInpAcBorderColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commInpAcBorderColor),r.find(".commInpAcBoxshadowColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commInpAcBoxshadowColor),r.find(".commButtColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commButtColor),r.find(".commButtBorderColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commButtBorderColor),r.find(".commClButtBoxshadowColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commClButtBoxshadowColor),r.find(".commClButtBgColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commClButtBgColor),r.find(".commClButtBorderColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commClButtBorderColor),r.find(".commClButtColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commClButtColor),r.find(".commClButtHoverColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commClButtHoverColor),r.find(".commCpButtBoxshadowColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commCpButtBoxshadowColor),r.find(".commCpButtBgColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commCpButtBgColor),r.find(".commCpButtColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commCpButtColor),r.find(".commCpButtHoverColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commCpButtHoverColor),r.find(".commCpButtBorderColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commCpButtBorderColor),r.find(".commAFontColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commAFontColor),r.find(".commTFontColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commTFontColor),r.find(".commDFontColor").colorpicker("setValue",a.grsSelectedTheme.lightbox.commDFontColor)},a.disablePerPlan=function(){if(!i.canUsePremium())return!0},a.grsAddTheme=function(){var o=angular.element(jQuery(".grsGallHeader")).scope();if(o.grsLoading)o.wmassage();else{if(i.isFreePlan()||i.isPersonalPlan())return!1;var e={action:"grsGalleryAjax",grsAction:"addTheme",grsAjaxNonce:scriptData.grsAjaxNonce};o.grsLoading=!0,n({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){o.grsLoading=!1;var r=e.data;i.log(e),void 0===r.error?(a.grsThemes.push(r.success),a.grsChangeTheme(a.grsThemes.length-1),o.grsMassage=a.getTrans("text_052"),o.grsMassageMood="success"):(o.grsMassage=a.getTrans("text_043"),o.grsMassageMood="error"),o.massage()},function(e){return i.log("errr"),$q.reject(e)})}},a.saveTheme=function(){var r=angular.element(jQuery(".grsGallHeader")).scope();if(r.grsLoading)r.wmassage();else{if(i.isFreePlan()||i.isPersonalPlan())return!1;var e={action:"grsGalleryAjax",grsAction:"updateTheme",theme:a.grsSelectedTheme,grsAjaxNonce:scriptData.grsAjaxNonce};r.grsLoading=!0,n({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){r.grsLoading=!1;e=e.data;i.log(e),void 0===e.error?(a.grsSelectedTheme.name=e.success[0],r.grsMassage=a.getTrans("text_052"),r.grsMassageMood="success"):(r.grsMassage=""==e.error?a.getTrans("text_043"):e.error,r.grsMassageMood="error"),r.massage()},function(e){return i.log("errr"),$q.reject(e)})}},a.grsDeleteThemePr=function(e,r){void 0!==e&&e.stopPropagation();var o=a.grsThemes[r].default,t=angular.element(jQuery(".grsGallHeader")).scope();if(1==o)return t.grsMassage=a.getTrans("text_053"),t.grsMassageMood="error",void t.massage();o=angular.element(jQuery(".grsGallConfirmMC")).scope(),t=jQuery(e.target).offset().left-jQuery(".grsGallFCont").offset().left,e=jQuery(e.target).offset().top-jQuery(".grsGallFCont").offset().top;o.options.show=!0,o.options.left=t,o.options.top=25+e,o.options.grsConMess=a.getTrans("text_046"),o.options.grsConIt=a.grsThemes[r].name,o.options.grsConTp=a.getTrans("text_054"),o.options.actCnt=".grsGallContent",o.options.actF="grsDeleteTheme",o.options.actP.push(r)},a.grsDeleteTheme=function(o){var e,t=angular.element(jQuery(".grsGallHeader")).scope();t.grsLoading?t.wmassage():(e={action:"grsGalleryAjax",grsAction:"deleteTheme",id:a.grsThemes[o].id,grsAjaxNonce:scriptData.grsAjaxNonce},t.grsLoading=!0,n({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){t.grsLoading=!1;e=e.data;if(void 0===e.error){if(a.grsSelectedTheme.id==a.grsThemes[o].id)for(var r=0;r<a.grsThemes.length;r++)1==a.grsThemes[r].default&&a.grsChangeTheme(r);a.grsThemes.splice(o,1),t.grsMassage=a.getTrans("text_055"),t.grsMassageMood="success"}else t.grsMassage=""==e.error?a.getTrans("text_043"):e.error,t.grsMassageMood="error";t.massage()},function(e){return i.log("errr"),$q.reject(e)}))},a.default=function(o){var e,t=angular.element(jQuery(".grsGallHeader")).scope();t.grsLoading?t.wmassage():(e={action:"grsGalleryAjax",grsAction:"setDefault",id:a.grsThemes[o].id,grsAjaxNonce:scriptData.grsAjaxNonce},1!=a.grsThemes[o].default&&(t.grsLoading=!0,n({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){t.grsLoading=!1;e=e.data;if(void 0===e.error){for(var r=0;r<a.grsThemes.length;r++)if(1==a.grsThemes[r].default){a.grsThemes[r].default=0;break}a.grsThemes[o].default=1,t.grsMassage=a.getTrans("text_052"),t.grsMassageMood="success"}else t.grsMassage=""==e.error?a.getTrans("text_043"):e.error,t.grsMassageMood="error";t.massage()},function(e){return i.log("errr"),$q.reject(e)})))},a.grsThemeView=function(e){a.options.view=e},a.getTrans=i.getTrans}}}]),grsApp.directive("grsAlbums",["$filter","$http","GrsAdminService",function(e,i,s){return{restrict:"E",transclude:!0,scope:!1,templateUrl:s.getViewsTemplateUrl("grsAlbums"),link:function(n,e,r){n.grsAlbums=[],n.grsGalleriesForAlb=[],n.showGallsForAdd=!1,n.showAlbsForAdd=!1,n.grsAlbAction="",n.pageination={items:[],currentPage:0,itemsPerPage:5},n.$watch("galleriesData",function(){n.grsGalleriesForAlb=angular.copy(n.galleriesData),n.$$phase||n.$apply()}),n.getAlbItems=function(){var r=angular.element(jQuery(".grsGallHeader")).scope(),e={action:"grsGalleryAjax",grsAction:"getAlbumItems",grsAjaxNonce:scriptData.grsAjaxNonce};r.grsLoading=!0,i({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){r.grsLoading=!1;e=e.data;void 0===e.error?n.grsAlbums=e.success:(r.grsMassage=n.getTrans("text_056"),r.grsMassageMood="error",r.massage())},function(e){return s.log("errr"),r.grsLoading=!1,r.grsMassage=n.getTrans("text_056"),r.grsMassageMood="error",r.massage(!1),$q.reject(e)})},n.getAlbItems(),n.contForAdd=function(e){n.selAlbExists()&&("gall"==e?n.showGallsForAdd=!n.showGallsForAdd:"alb"==e&&(n.showAlbsForAdd=!n.showAlbsForAdd))},n.$watch("grsAlbums",function(){switch(n.pageination.items=angular.copy(n.grsAlbums),void 0!==n.pageination.search&&n.pageination.search(),n.grsAlbAction){case"addAlbum":n.pageination.firstPage(),n.grsChangeAlbum(0);break;case"updateAlbum":for(var e=0;e<n.pageination.pagedItems.length;e++)for(var r=0;r<n.pageination.pagedItems[e].length;r++)if(n.pageination.pagedItems[e][r].id==n.grsSelectedAlbum.id){n.pageination.currentPage=e;break}break;case"deleteAlbum":case"deleteAlbContent":if(void 0===n.grsSelectedAlbum)return;for(e=0;e<n.pageination.pagedItems.length;e++)for(r=0;r<n.pageination.pagedItems[e].length;r++)if(n.pageination.pagedItems[e][r].id==n.grsSelectedAlbum.id){n.grsSelectedAlbum.content=n.pageination.pagedItems[e][r].content;break}break;case"addAlbContent":for(e=0;e<n.grsAlbums.length;e++)if(n.grsAlbums[e].id==n.grsSelectedAlbum.id){n.grsAlbums[e].content=n.grsSelectedAlbum.content;break}n.pageination.items=angular.copy(n.grsAlbums),n.pageination.search();break;default:return}n.grsAlbAction="",n.$$phase||n.$apply()}),n.$watch("pageination.currentPage",function(){n.isAllChecked=!1,n.checkAll()}),n.checkAll=function(){var r=n.isAllChecked,e=n.pageination;e.pagedItems&&angular.forEach(e.pagedItems[e.currentPage],function(e){e.checked=r})},n.checked=function(){var e=n.pageination;n.isAllChecked=e.pagedItems[e.currentPage].every(function(e){return e.checked})},n.grsChangeAlbum=function(e){n.grsSelectedAlbum=n.pageination.pagedItems[n.pageination.currentPage][e];e="grsnopv"==n.grsSelectedAlbum.prevImgName?s.imagesDir:s.uploaderUrl;n.grsSelectedAlbum.pvAlbIm=e+n.grsSelectedAlbum.prevImgPath+"thumbnail/"+n.grsSelectedAlbum.prevImgName+n.grsSelectedAlbum.prevImgType},n.grsAddAlbum=function(){var e,o=angular.element(jQuery(".grsGallHeader")).scope();o.grsLoading?o.wmassage():(e={action:"grsGalleryAjax",grsAction:"addUpdateAlbum",grsAjaxNonce:scriptData.grsAjaxNonce},o.grsLoading=!0,i({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){s.log(e),o.grsLoading=!1;var r=e.data;void 0===r.error?(e={id:r.success[0],title:r.success[1],description:"",content:[],prevImgPath:"",prevImgName:"grsnopv",prevImgType:".png"},n.grsAlbums.push(e),n.grsAlbums=angular.copy(n.grsAlbums),n.grsAlbAction="addAlbum",o.grsMassage=n.getTrans("text_057"),o.grsMassageMood="success"):(o.grsMassage=""==r.error?n.getTrans("text_043"):r.error,o.grsMassageMood="error"),o.massage()},function(e){return s.log("errr"),$q.reject(e)}))},n.saveAlb=function(){var e,t=angular.element(jQuery(".grsGallHeader")).scope();t.grsLoading?t.wmassage():n.selAlbExists()&&(e={action:"grsGalleryAjax",grsAction:"addUpdateAlbum",album:n.grsSelectedAlbum,grsAjaxNonce:scriptData.grsAjaxNonce},t.grsLoading=!0,i({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){t.grsLoading=!1;var r=e.data;if(void 0===r.error){for(var o=0;o<n.grsAlbums.length;o++)n.grsAlbums[o].id==n.grsSelectedAlbum.id&&(n.grsSelectedAlbum.title=r.success[0],n.grsAlbums[o]=n.grsSelectedAlbum,n.updateAlbsContents(n.grsSelectedAlbum.id,r.success[0],"alb"));t.grsMassage=n.getTrans("text_057"),t.grsMassageMood="success"}else t.grsMassage=""==r.error?n.getTrans("text_043"):r.error,t.grsMassageMood="error";t.massage()},function(e){return s.log("errr"),$q.reject(e)}))},n.grsDeleteAlbumPr=function(e,r){void 0!==e&&e.stopPropagation();var o=angular.element(jQuery(".grsGallConfirmMC")).scope(),t=jQuery(e.target).offset().left-jQuery(".grsGallFCont").offset().left,a=jQuery(e.target).offset().top-jQuery(".grsGallFCont").offset().top;o.options.left=t,o.options.top=25+a,o.options.actCnt=".grsGallContent","SPAN"==e.target.nodeName?(o.options.grsConMess=n.getTrans("text_046"),o.options.grsConIt=n.grsAlbums[r].title,o.options.grsConTp=n.getTrans("text_058"),o.options.actF="grsDeleteAlbum",o.options.actP.push(r)):(o.options.grsConMess=n.getTrans("text_011"),o.options.actF="grsDeleteAlbums",o.options.actP.push("")),o.options.show=!0},n.grsDeleteAlbum=function(e){var r=[],o=n.pageination;r.push(o.pagedItems[o.currentPage][e].id),n.deleteAlbums(r)},n.grsDeleteAlbums=function(){for(var e=[],r=n.pageination,o=0;o<r.pagedItems[r.currentPage].length;o++)r.pagedItems[r.currentPage][o].checked&&e.push(r.pagedItems[r.currentPage][o].id);0<e.length&&n.deleteAlbums(e)},n.deleteAlbums=function(t){var e,a=angular.element(jQuery(".grsGallHeader")).scope();a.grsLoading?a.wmassage():(e={action:"grsGalleryAjax",grsAction:"deleteAlbum",ids:t,grsAjaxNonce:scriptData.grsAjaxNonce},a.grsLoading=!0,i({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){s.log(e),a.grsLoading=!1;e=e.data;if(void 0===e.error){void 0!==n.grsSelectedAlbum&&-1!==jQuery.inArray(n.grsSelectedAlbum.id,t)&&(n.grsSelectedAlbum={}),s.log(n.grsAlbums),s.log(t);for(var r=0;r<t.length;r++)for(var o=0;o<n.grsAlbums.length;o++)n.grsAlbums[o].id==t[r]&&n.grsAlbums.splice(o,1);for(r=0;r<t.length;r++)n.delAlbsContsFromPrnt(t[r],"alb");a.grsMassage=n.getTrans("text_059"),a.grsMassageMood="success"}else a.grsMassage=(e.error="",e.error),a.grsMassageMood="error";a.massage()},function(e){return s.log("errr"),$q.reject(e)}))},n.grsAddGalleryForAlbum=function(e){n.grsAddContentForAlbum("gal",n.grsGalleriesForAlb[e])},n.grsAddAlbumForAlbum=function(e){n.grsAddContentForAlbum("alb",n.grsAlbums[e])},n.grsAddContentForAlbum=function(o,t){var e,a=angular.element(jQuery(".grsGallHeader")).scope();a.grsLoading?a.wmassage():"gal"==o||"alb"==o?(e={action:"grsGalleryAjax",grsAction:"addContentForAlbum",albId:n.grsSelectedAlbum.id,type:o,contentId:t.id,grsAjaxNonce:scriptData.grsAjaxNonce},a.grsLoading=!0,i({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){a.grsLoading=!1;var r=e.data;void 0===r.error?((e={}).albId=n.grsSelectedAlbum.id,e.type=o,e.contentId=t.id,e.id=r.success,e.description=t.description,e.title=t.title,e.prevImgName=t.prevImgName,e.prevImgPath=t.prevImgPath,e.prevImgType=t.prevImgType,n.grsSelectedAlbum.content.push(e),n.grsAlbAction="addAlbContent",n.grsAlbums=angular.copy(n.grsAlbums),a.grsMassage=n.getTrans("text_057"),a.grsMassageMood="success"):(a.grsMassage=r.error,a.grsMassageMood="error"),a.massage()},function(e){return s.log("errr"),$q.reject(e)})):s.log("error, undefined type")},n.grsDeleteAlbumContent=function(r){var e,o=angular.element(jQuery(".grsGallHeader")).scope();o.grsLoading?o.wmassage():(e={action:"grsGalleryAjax",grsAction:"deleteContentFromAlbum",id:n.grsSelectedAlbum.content[r].id,grsAjaxNonce:scriptData.grsAjaxNonce},o.grsLoading=!0,i({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){o.grsLoading=!1;e=e.data;void 0===e.error?(n.grsSelectedAlbum.content.splice(r,1),o.grsMassage=n.getTrans("successfully deleted"),o.grsMassageMood="success"):(o.grsMassage=(e.error="",e.error),o.grsMassageMood="error"),o.massage()},function(e){return s.log("errr"),$q.reject(e)}))},n.delAlbsContsFromPrnt=function(e,r){for(var o=0;o<n.grsAlbums.length;o++)for(var t=0;t<n.grsAlbums[o].content.length;t++)n.grsAlbums[o].content[t].contentId==e&&n.grsAlbums[o].content[t].type==r&&n.grsAlbums[o].content.splice(t,1);n.grsAlbAction="deleteAlbum",n.grsAlbums=angular.copy(n.grsAlbums)},n.updateAlbsContents=function(e,r,o){for(var t=0;t<n.grsAlbums.length;t++)for(var a=0;a<n.grsAlbums[t].content.length;a++)n.grsAlbums[t].content[a].contentId==e&&n.grsAlbums[t].content[a].type==o&&(n.grsAlbums[t].content[a].title=r,n.grsSelectedAlbum&&n.grsAlbums[t].id==n.grsSelectedAlbum.id&&(n.grsSelectedAlbum.content[a].title=r));n.grsAlbums=angular.copy(n.grsAlbums)},n.activeAPw=function(){var e,r;n.selAlbExists()&&(e=angular.element(jQuery(".grsGallUpl")).scope(),r=angular.element(jQuery(".grsGallHeader")).scope(),e.options.show||r.selectTab("Upl"),e.options.addAction="addPwAIm",e.options.addImages=!1,e.options.addImageTitle=n.getTrans("text_060"))},n.selAlbExists=function(){if(void 0!==n.grsSelectedAlbum)return!0;var e=angular.element(jQuery(".grsGallHeader")).scope();return e.grsMassage=n.getTrans("Select album"),e.grsMassageMood="error",e.massage(),!1},n.addPvIm=function(e,r,o){for(var t=0;t<n.grsAlbums.length;t++)if(n.grsAlbums[t].id==n.grsSelectedAlbum.id){n.grsSelectedAlbum.prevImgName=r,n.grsSelectedAlbum.prevImgPath=e,n.grsSelectedAlbum.prevImgType=o,n.grsSelectedAlbum.pvAlbIm=s.uploaderUrl+e+"thumbnail/"+r+o,n.grsSelectedAlbum.hidePvIm=!0,n.grsAlbums[t]=n.grsSelectedAlbum;break}},n.getPrevImg=function(e){var r=n.pageination;if(void 0!==r.pagedItems[r.currentPage]&&void 0!==r.pagedItems[r.currentPage][e]){e=r.pagedItems[r.currentPage][e];return("grsnopv"==e.prevImgName?s.imagesDir:s.uploaderUrl)+e.prevImgPath+"thumbnail/"+e.prevImgName+e.prevImgType}},n.getTrans=s.getTrans}}}]),grsApp.directive("grsSettings",["$filter","$http","GrsAdminService",function(e,t,n){return{restrict:"E",transclude:!0,scope:!1,templateUrl:n.getViewsTemplateUrl("grsSettings"),link:function(a,e,r){a.data={},a.checkTDis=function(){return n.isProPlan()||n.isElitePlan()},a.checkFilmDis=function(){return n.isPremium},a.getSettings=function(){var r=angular.element(jQuery(".grsGallHeader")).scope(),e={action:"grsGalleryAjax",grsAction:"getSettings",grsAjaxNonce:scriptData.grsAjaxNonce};r.grsLoading=!0,t({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){n.log(e),r.grsLoading=!1;e=e.data;void 0===e.error?a.data=e.success:(r.grsMassage=""==e.error?a.getTrans("text_061"):e.error,r.grsMassageMood="error",r.massage())},function(e){return n.log("errr"),r.grsLoading=!1,r.grsMassage=a.getTrans("text_061"),r.grsMassageMood="error",r.massage(!1),$q.reject(e)})},a.getSettings(),a.saveSett=function(){var e,o=angular.element(jQuery(".grsGallHeader")).scope();o.grsLoading?o.wmassage():(e={action:"grsGalleryAjax",grsAction:"saveSettings",settings:a.data.settings,grsAjaxNonce:scriptData.grsAjaxNonce},o.grsLoading=!0,t({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){o.grsLoading=!1;var r=e.data;n.log(e),void 0===r.error?(o.grsMassage=a.getTrans("text_062"),o.grsMassageMood="success"):(o.grsMassage=""==r.error?a.getTrans("text_043"):r.error,o.grsMassageMood="error"),o.massage()},function(e){return n.log("errr"),$q.reject(e)}))},a.uninstallPr=function(e,r){void 0!==e&&e.stopPropagation();var o=angular.element(jQuery(".grsGallConfirmMC")).scope(),t=jQuery(e.target).offset().left-jQuery(".grsGallFCont").offset().left,e=jQuery(e.target).offset().top-jQuery(".grsGallFCont").offset().top;o.options.left=t-209,o.options.width="209px",o.options.top=30+e,o.options.actCnt=".grsGallContent",o.options.grsConMess=a.getTrans("text_015"),o.options.grsConMessCont="_limb_gallery_galleries, _limb_gallery_galleriescontent, _limb_gallery_settings, _limb_gallery_themes, _limb_gallery_comments, _limb_gallery_albumscontent, _limb_gallery_albums, _limb_gallery_shortcodes",o.options.grsConMessFoot=a.getTrans("text_012"),o.options.br=!0,o.options.actF="uninstall",o.options.actP.push(""),o.options.show=!0},a.uninstall=function(){var e,o=angular.element(jQuery(".grsGallHeader")).scope();o.grsLoading?o.wmassage():(e={action:"grsGalleryAjax",grsAction:"uninstall",grsAjaxNonce:scriptData.grsAjaxNonce},o.grsLoading=!0,t({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){o.grsLoading=!1;var r=e.data;n.log(e),void 0!==r.success?o.grsMassage=1==r.success?a.getTrans("Plugin uninstalled"):r.success:o.grsMassage=""==r.error?a.getTrans("text_043"):r.error,o.grsMassageMood="error",o.massage()},function(e){return n.log("errr"),$q.reject(e)}))},a.getTrans=n.getTrans,a.upgradeUrl=n.upgradeUrl}}}]),grsApp.directive("grsPageNav",["$filter","GrsAdminService",function(o,e){return{restrict:"E",transclude:!0,scope:{pageInation:"="},templateUrl:e.getViewsTemplateUrl("grsPageNav"),link:function(t,e,r){t.order="id",t.reverse=!0;t.pageInation.search=function(e){angular.isUndefined(e)||(t.query=e),t.pageInation.filteredItems=o("filter")(t.pageInation.items,function(e){for(var r in e.id=parseInt(e.id),e)if("title"==r&&(o=e[r],!(r=t.query)||-1!==o.toLowerCase().indexOf(r.toLowerCase())))return!0;var o;return!1}),t.pageInation.filteredItems=o("orderBy")(t.pageInation.filteredItems,t.order,t.reverse),t.pageInation.groupToPages(),t.pageInation.firstPage()},t.pageInation.groupToPages=function(){t.pageInation.pagedItems=[];for(var e=0;e<t.pageInation.filteredItems.length;e++)e%t.pageInation.itemsPerPage==0?t.pageInation.pagedItems[Math.floor(e/t.pageInation.itemsPerPage)]=[t.pageInation.filteredItems[e]]:t.pageInation.pagedItems[Math.floor(e/t.pageInation.itemsPerPage)].push(t.pageInation.filteredItems[e])},t.pageInation.range=function(e,r){var o=[];r||(r=e,e=0);for(var t=e;t<r;t++)o.push(t);return o},t.pageInation.prevPage=function(e){void 0!==e&&e.stopPropagation(),0<t.pageInation.currentPage&&t.pageInation.currentPage--},t.pageInation.nextPage=function(e){void 0!==e&&e.stopPropagation(),t.pageInation.currentPage<t.pageInation.pagedItems.length-1&&t.pageInation.currentPage++},t.pageInation.lastPage=function(e){void 0!==e&&e.stopPropagation(),t.pageInation.currentPage<t.pageInation.pagedItems.length-1&&(t.pageInation.currentPage=t.pageInation.pagedItems.length-1)},t.pageInation.firstPage=function(e){void 0!==e&&e.stopPropagation(),0<t.pageInation.currentPage&&(t.pageInation.currentPage=0)},t.setPage=function(e){void 0!==e&&e.stopPropagation(),t.pageInation.currentPage=this.n},t.pageInation.search()}}}]),grsApp.controller("grsUploader",["$scope","$filter","$log","GrsAdminService",function(e,r,o,t){}]),grsApp.directive("grsUploader",["$filter","$http","$timeout","GrsAdminService",function(r,B,i,j){return{restrict:"E",transclude:!0,scope:!1,templateUrl:j.getViewsTemplateUrl("grsUploader"),link:function(x,s,e){x.sortingOrder="id",x.reverse=!1,x.filteredItems=[],x.groupedItems=[],x.pageSize=5,x.itemsPerPage=x.pageSize,x.pagedItems=[],x.currentPage=0,x.curentDirIndex=0,x.parentDirIndex=-1,x.mainItems=[],x.dirsData=[],x.items=[],x.itemsLength=function(){return x.items.length},x.options={show:!1,addImage:!1,addImages:!1,delImages:!1,addAction:"",addImageTitle:"Add",activeTab:""},x.activeTab=function(e){switch(e){case"Gall":x.options.addImage=!0,x.options.addImages=!0,x.options.addAction="addImages",x.options.activeTab="Gall";break;case"Alb":x.options.addImage=!0,x.options.addImages=!1,x.options.addAction="addPwAIm",x.options.addImageTitle=x.getTrans("text_060"),x.options.activeTab="Alb";break;case"Theme":x.options.addImage=!1,x.options.addImages=!1,x.options.addAction="",x.options.activeTab="Theme";case"Sett":x.options.addImage=!1,x.options.addImages=!1,x.options.addAction="",x.options.activeTab="Sett"}},x.$watch("currentPage",function(){x.unSelectAll()}),x.closeUpl=function(){x.options.show=!1},x.dirs=[],x.dirs.push({dirname:"limb-gallery",dirindex:0}),x.getItems=function(){var r=angular.element(jQuery(".grsGallHeader")).scope(),e={action:"grsGalleryAjax",grsAction:"getUploderItems",grsAjaxNonce:scriptData.grsAjaxNonce};r.grsLoading=!0,B({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){r.grsLoading=!1;e=e.data;angular.isUndefined(e.error)?(x.dirsData=e.success,x.changeDir(0)):(r.grsMassage=""===e.error?x.getTrans("text_063"):e.error,r.grsMassageMood="error",r.massage())},function(e){return j.log("errr"),r.grsLoading=!1,r.grsMassage=x.getTrans("text_063"),r.grsMassageMood="error",r.massage(!1),$q.reject(e)})},x.getItems(),x.upload=function(e){e.preventDefault(),s.find("#upload #grsUpload").click()},x.uplLsrc=function(){return j.imagesDir+"admin/ring-alt-u.svg"},x.uploadInProgress=function(e){if(angular.isUndefined(x.pagedItems[x.currentPage]))return!1;for(var r=0;r<x.pagedItems[x.currentPage].length;r++)if(!angular.isUndefined(x.pagedItems[x.currentPage][r].canAdd)&&!x.pagedItems[x.currentPage][r].canAdd)return!0;return!1},x.changeDir=function(e,r){if(x.uploadInProgress()){var o=angular.element(jQuery(".grsGallHeader")).scope();return o.grsMassage=x.getTrans("text_064"),o.grsMassageMood="error",void o.massage()}if(angular.isUndefined(r)||(r.stopPropagation(),r.preventDefault()),-1!=e&&""!==e){x.unSelectAll();for(var t=0;t<x.dirsData.length;t++)if(x.dirsData[t].curentDirIndex==e){var a=x.dirsData[t];x.items=a.items;break}x.parentDirIndex=a.parentDirIndex,x.curentDirIndex=e,x.parentDirPath=a.path;for(var r=(r=x.parentDirPath.split("/"))[r.length-2],n=0,i=[],s=0;s<x.dirs.length;s++)parseInt(x.dirs[s].dirindex)>parseInt(e)?i.push(x.dirs[s].dirindex):parseInt(x.dirs[s].dirindex)<parseInt(e)&&n++;for(var l=0;l<i.length;l++)for(t=0;t<x.dirs.length;t++)if(x.dirs[t].dirindex==i[l]){x.dirs.splice(t,1);break}n==s&&x.dirs.push({dirname:r,dirindex:e}),x.search()}},x.back=function(){x.changeDir(x.parentDirIndex)},x.changeMode=function(e){if(-1!=x.options.modes.indexOf(e)){for(var r=0;r<x.buttons.header.length;r++){var o=x.buttons.header[r].activeIn.indexOf(e);x.buttons.header[r].printC=-1!=o?x.buttons.header[r].activeC:x.buttons.header[r].deActiveC,x.buttons.header[r].active=-1!=o}x.options.activeMode=e}else j.log("no such mode")},x.addItem=function(e,r,o,t,a,n,i){n&&x.dirsData.push({curentDirIndex:a,parentDirIndex:x.curentDirIndex,path:x.parentDirPath+r+"/",items:[]}),x.items.splice(0,0,{key:e,name:r,dirPath:o,path:t,dirIndex:a,isDir:n,ext:i,canAdd:!!n}),x.search(),x.pageSize++,x.itemsPerPage=x.pageSize,x.firstPage()},x.addFolder=function(e){e.preventDefault();var o=angular.element(jQuery(".grsGallHeader")).scope();o.grsLoading?o.wmassage():(e={action:"grsGalleryAjax",grsAction:"addFolderInUploader",parentDirPath:x.parentDirPath,_method:"ADDFOLDER",grsAjaxNonce:scriptData.grsAjaxNonce},key=x.itemsLength(),path=j.imagesDir+"admin/folder.png",dirIndex=x.dirsData.length,isDir=!0,o.grsLoading=!0,B({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){j.log(e),o.grsLoading=!1;var r=e.data,e=Object.keys(r)[0];void 0===r.error&&r[e]?(x.addItem(key,e,x.parentDirPath+e,path,dirIndex,isDir,""),o.grsMassage=x.getTrans("text_065"),o.grsMassageMood="success"):(o.grsMassage=""==r.error?x.getTrans("text_043"):r.error,o.grsMassageMood="error"),o.massage()},function(e){return j.log("errr"),$q.reject(e)}))},x.select=function(e,r){r.preventDefault(),r.stopPropagation();e=x.pagedItems[x.currentPage][e];e.select=!e.select},x.isAllSelected=function(){return void 0!==x.pagedItems[x.currentPage]&&x.pagedItems[x.currentPage].every(function(e){return e.select})},x.isSingleSelExist=function(){if(void 0!==x.pagedItems[x.currentPage])for(var e=0;e<x.pagedItems[x.currentPage].length;e++)if(x.pagedItems[x.currentPage][e].select)return!0;return!1},x.isSingleImgSelExist=function(){if(void 0!==x.pagedItems[x.currentPage])for(var e=0;e<x.pagedItems[x.currentPage].length;e++)if(x.pagedItems[x.currentPage][e].select&&!x.pagedItems[x.currentPage][e].isDir)return!0;return!1},x.checkAddImgC=function(e){return x.options.addImages&&x.isSingleImgSelExist()},x.selectAll=function(e){var r=!x.isAllSelected();angular.forEach(x.pagedItems[x.currentPage],function(e){e.select=r})},x.unSelectAll=function(){angular.forEach(x.pagedItems[x.currentPage],function(e){e.select=!1})},x.grsDeleteUpImgPr=function(e,r){void 0!==e&&e.stopPropagation();var o=angular.element(jQuery(".grsGallConfirmMC")).scope(),t=jQuery(e.target).offset().left-jQuery(".grsGallFCont").offset().left,a=jQuery(e.target).offset().top-jQuery(".grsGallFCont").offset().top;if(o.options.left=t,o.options.top=25+a,o.options.actCnt=".grsGallUpl","grsGallUplImgD"==e.target.className)o.options.grsConMess=x.getTrans("text_046"),o.options.grsConIt=x.pagedItems[x.currentPage][r].name,o.options.grsConTp=x.pagedItems[x.currentPage][r].isDir?x.getTrans("text_066"):x.getTrans("text_067"),o.options.actF="deleteImg",o.options.actP.push(r);else{if(!x.isSingleSelExist()){r=angular.element(jQuery(".grsGallHeader")).scope();return r.grsMassage=x.getTrans("text_068"),r.grsMassageMood="success",void r.massage()}o.options.grsConMess=x.getTrans("text_010"),o.options.actF="deleteImgs",o.options.actP.push("")}o.options.show=!0},x.deleteImg=function(o){var t,e,a=angular.element(jQuery(".grsGallHeader")).scope();a.grsLoading?a.wmassage():(e=x.pagedItems[x.currentPage][o],t=x.itemsPerPage*x.currentPage+parseInt(o),grsAction="delItemsFromUploader",files=[],files[0]=e.name+(e.isDir?"":e.ext),e={action:"grsGalleryAjax",grsAction:grsAction,_method:"DELETE",parentDirPath:x.parentDirPath,files:files,grsAjaxNonce:scriptData.grsAjaxNonce},a.grsLoading=!0,B({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){a.grsLoading=!1;var r=e.data;j.log(e),void 0===r.error?(x.deleteItemsInContent(r),x.pagedItems[x.currentPage][o].delete=!0,i(function(){x.items.splice(t,1),x.search()},500),a.grsMassage=x.getTrans("text_069"),a.grsMassageMood="success"):(a.grsMassage=r.error,a.grsMassageMood="error"),a.massage()},function(e){return j.log("errr"),$q.reject(e)}))},x.deleteImgs=function(){var o,t,a,e,n=angular.element(jQuery(".grsGallHeader")).scope();n.grsLoading?n.wmassage():(o=[],t=[],a=[],angular.forEach(x.pagedItems[x.currentPage],function(e){var r;e.select&&(r=e.name+(e.isDir?"":e.ext),o.push(r),t.push(e.name),a.push(e))}),e={action:"grsGalleryAjax",grsAction:"delItemsFromUploader",_method:"DELETE",parentDirPath:x.parentDirPath,files:o,grsAjaxNonce:scriptData.grsAjaxNonce},n.grsLoading=!0,B({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){n.grsLoading=!1;var r=e.data;if(j.log(e),void 0===r.error){x.deleteItemsInContent(r);for(var o=0;o<a.length;o++)a[o].delete=!0;i(function(){for(var e=0;e<t.length;e++)for(var r=0;r<x.items.length;r++)x.items[r].name==t[e]&&x.items.splice(r,1);x.search()},500),n.grsMassage=x.getTrans("text_048"),n.grsMassageMood="success"}else n.grsMassage=r.error,n.grsMassageMood="error";n.massage()},function(e){return j.log("errr"),$q.reject(e)}))},x.deleteItemsInContent=function(e){var r=angular.element(jQuery(".grsGallContent")).scope();if(0<e.length){for(var o=0;o<e.length;o++){for(var t=0;t<r.galleriesData.length;t++){for(var a=0;a<r.galleriesData[t].images.length;a++){var n=r.galleriesData[t].images[a];void 0!==e[o].name&&n.name==e[o].name&&n.path==e[o].path&&e[o].success&&r.galleriesData[t].images.splice(a,1)}void 0!==e[o].name&&r.galleriesData[t].prevImgName==e[o].name&&r.galleriesData[t].prevImgPath==e[o].path&&e[o].success&&(r.galleriesData[t].prevImgName="grsnopv",r.galleriesData[t].prevImgPath="",r.galleriesData[t].prevImgType=".png"),void 0!==r.selGall&&r.selGall.id==r.galleriesData[t].id&&r.changeGallery(r.galleriesData[t].id)}for(t=0;t<r.grsAlbums.length;t++)void 0!==e[o].name&&r.grsAlbums[t].prevImgName==e[o].name&&r.grsAlbums[t].prevImgPath==e[o].path&&e[o].success&&(r.grsAlbums[t].prevImgName="grsnopv",r.grsAlbums[t].prevImgPath="",r.grsAlbums[t].prevImgType=".png"),void 0!==r.grsSelectedAlbum&&r.grsSelectedAlbum.id==r.grsAlbums[t].id&&r.grsChangeAlbum(t)}r.$$phase||r.$apply()}},x.showIn=function(e,r){x.pagedItems[x.currentPage][e].rename=!0,x.pagedItems[x.currentPage][e].lastName=x.pagedItems[x.currentPage][e].name,r.preventDefault(),r.stopPropagation()},x.rename=function(e){var r=angular.element(jQuery(".grsGallHeader")).scope(),o=!1,t=x.pagedItems[x.currentPage][e];if(r.grsLoading)r.wmassage();else{if(-1!=t.name.indexOf('"')?(r.grsMassage=x.getTrans("text_006"),o=!0):""==t.name&&(r.grsMassage=x.getTrans("text_007"),o=!0),o)return t.name=t.lastName,r.grsMassageMood="error",void r.massage();x.itemsPerPage,x.currentPage,parseInt(e);grsAction="renameItemInUploader",data={action:"grsGalleryAjax",grsAction:grsAction,parentDirPath:x.parentDirPath,_method:"RENAME",itemNewName:t.name+t.ext,itemName:t.lastName+t.ext,grsAjaxNonce:scriptData.grsAjaxNonce},r.grsLoading=!0,B({method:"POST",url:grsAdminAjax,data:jQuery.param(data),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){r.grsLoading=!1;e=e.data;void 0!==e.success&&e.success?(x.renameItem(e.old_name,e.new_name),t.rename=!1,r.grsMassage=x.getTrans("text_070"),r.grsMassageMood="success"):(r.grsMassage=e.error,r.grsMassageMood="error",t.name=t.lastName,t.rename=!1),r.massage()},function(e){return j.log("errr"),$q.reject(e)})}},x.renameItem=function(e,u){for(var d=[],r=0;r<x.items.length;r++)if(e===x.items[r].lastName){if(x.items[r].name=u,x.items[r].isDir){for(var o=x.items[r].dirIndex,t=0;t<x.dirsData.length;t++)if(x.dirsData[t].curentDirIndex==o){(a=(a=x.dirsData[t].path).split("/"))[a.length-2]=u,x.dirsData[t].path=a.join("/");break}!function e(r,o){o+=1;for(var t=0;t<x.dirsData.length;t++)if(x.dirsData[t].curentDirIndex==r)for(var a=0;a<x.dirsData[t].items.length;a++)if(x.dirsData[t].items[a].isDir){curDirIndex=x.dirsData[t].items[a].dirIndex;for(var n=0;n<x.dirsData.length;n++)if(x.dirsData[n].curentDirIndex==curDirIndex){(i=(i=x.dirsData[n].path).split("/"))[i.length-o]=u,x.dirsData[n].path=i.join("/"),e(curDirIndex,o);break}}else{var i,s=(i=x.dirsData[t].items[a].path).split(j.uploaderUrl+x.parentDirPath),l=x.dirsData[t].items[a].name+x.dirsData[t].items[a].ext,g={};j.log(i),j.log(x.parentDirPath),(i=i.split("/"))[i.length-o]=u,x.dirsData[t].items[a].path=i.join("/");var c=i.join("/").split(j.uploaderUrl+x.parentDirPath);g.name=x.dirsData[t].items[a].name,g.oldPath=s[1].replace("/thumbnail","").replace(l,""),g.newPath=c[1].replace("/thumbnail","").replace(l,""),d.push(g)}}(o,2)}else{var a=x.items[r].path,n={};n.newName=u,n.oldName=x.items[r].lastName,n.path=x.parentDirPath,d.push(n),(a=a.split("/"))[a.length-1]=u,x.items[r].path=a.join("/")+x.items[r].ext}x.renameItemsInContent(d);break}},x.renameItemsInContent=function(e){var r=angular.element(jQuery(".grsGallContent")).scope();if(0<e.length){for(var o=0;o<e.length;o++){for(var t=0;t<r.galleriesData.length;t++){for(var a=0;a<r.galleriesData[t].images.length;a++){var n=r.galleriesData[t].images[a];void 0!==e[o].newName?n.name==e[o].oldName&&n.path==e[o].path&&(n.name=e[o].newName):void 0!==e[o].newPath&&n.path==e[o].oldPath&&n.name==e[o].name&&(n.path=e[o].newPath)}void 0!==e[o].newName?r.galleriesData[t].prevImgName==e[o].oldName&&r.galleriesData[t].prevImgPath==e[o].path&&(r.galleriesData[t].prevImgName=e[o].newName):void 0!==e[o].newPath&&r.galleriesData[t].prevImgPath==e[o].oldPath&&r.galleriesData[t].prevImgName==e[o].name&&(r.galleriesData[t].prevImgPath=e[o].newPath)}for(t=0;t<r.grsAlbums.length;t++)void 0!==e[o].newName?r.grsAlbums[t].prevImgName==e[o].oldName&&r.grsAlbums[t].prevImgPath==e[o].path&&(r.grsAlbums[t].prevImgName=e[o].newName):void 0!==e[o].newPath&&r.grsAlbums[t].prevImgPath==e[o].oldPath&&r.grsAlbums[t].prevImgName==e[o].name&&(r.grsAlbums[t].prevImgPath=e[o].newPath)}r.$$phase||r.$apply()}},x.addImage=function(e,r){if(r.stopPropagation(),r.preventDefault(),x.options.addImage){var o=x.pagedItems[x.currentPage][e];if(void 0!==o.canAdd&&!o.canAdd){var t=angular.element(jQuery(".grsGallHeader")).scope();return t.grsMassage=x.getTrans("text_064"),t.grsMassageMood="error",void t.massage()}o.select=!1;var a=[],n=[],r=[],e=[],t=document.querySelector("#grsImageKey"+o.key+" .grsGallUplImg"),t={nW:t.naturalWidth,nH:t.naturalHeight};a.push(o.name),n.push(o.ext),r.push(s.find("#grsImageKey"+o.key)),e.push(t),x.addSave(a,n,r,e)}},x.addImages=function(){var e=angular.element(jQuery(".grsGallHeader")).scope();if(!x.isSingleImgSelExist())return e.grsMassage=x.getTrans("text_071"),e.grsMassageMood="success",void e.massage();if(!x.options.addImages)return e.grsMassage=x.getTrans("text_001"),e.grsMassageMood="success",void e.massage();var r=[],o=[],t=[],a=!1,n=!1,i=[];if(angular.forEach(x.pagedItems[x.currentPage],function(e){e.select&&(e.isDir?a=!0:void 0===e.canAdd||e.canAdd?(e.select=!1,imDomS=document.querySelector("#grsImageKey"+e.key+" .grsGallUplImg"),nRob={nW:imDomS.naturalWidth,nH:imDomS.naturalHeight},r.push(e.name),o.push(e.ext),t.push(s.find("#grsImageKey"+e.key)),i.push(nRob)):n=!0)}),a&&(e.grsMassage=x.getTrans("text_072"),e.grsMassageMood="success",e.massage()),n)return(e=angular.element(jQuery(".grsGallHeader")).scope()).grsMassage=x.getTrans("text_064"),e.grsMassageMood="error",void e.massage();0<r.length&&x.addSave(r,o,t,i)},x.addSave=function(e,r,o,t){var a=angular.element(jQuery(".grsGallHeader")).scope();if(a.grsLoading)a.wmassage();else{var n=[],i=[],s=[],l=jQuery(".grsGallContent"),g=angular.element(l).scope(),c=g.getMinOrder();l.removeClass("grsAnDur grsFadeIn"),grsAction=x.options.addAction;for(var u=0;u<e.length;u++){var d=e[u],m=r[u],p=o[u],f=t[u];switch(grsAction){case"addImages":grsId=g.selGall.id;var h,v,C=--c;s.push(C),g.selGall.imagesCount=g.selGall.imagesCount?parseInt(g.selGall.imagesCount)+1:1,i.push(g.selGall.imagesCount),g.addItem(d,d,"",x.parentDirPath,"",C,m,"","",g.selGall.imagesCount,null),grsGFImC=l.find(".grsGallCoGaImsC"),jQuery(".grsGallCoGaC").removeClass("grsAnDur grsSlideInRight"),1<f.nW/f.nH?(v=228<f.nW?228:f.nW,h=f.nH*v/f.nW):(h=166<f.nH?166:f.nH,v=f.nW*h/f.nH);var b=9+grsGFImC.offset().left+(228-v)/2-p.offset().left,y=0+grsGFImC.offset().top+(166-h)/2-p.offset().top;break;case"addGPvIm":grsId=g.selGall.id,g.addGPvIm(x.parentDirPath,d,m),jQuery(".grsGallCoGaC").removeClass("grsAnDur grsSlideInRight"),1<f.nW/f.nH?(v=81<f.nW?81:f.nW,h=f.nH*v/f.nW):(h=81<f.nH?81:f.nH,v=f.nW*h/f.nH);b=l.find(".grsGallCoGaInPic").offset().left+(81-v)/2-p.offset().left,y=l.find(".grsGallCoGaInPic").offset().top+(81-h)/2-p.offset().top;break;case"addPwAIm":grsId=g.grsSelectedAlbum.id,g.addPvIm(x.parentDirPath,d,m),jQuery(".grsGallCoAlbC").removeClass("grsAnDur grsSlideInLeft"),1<f.nW/f.nH?(v=81<f.nW?81:f.nW,h=f.nH*v/f.nW):(h=81<f.nH?81:f.nH,v=f.nW*h/f.nH);b=l.find(".grsGallCoAlbPic").offset().left+(81-v)/2-p.offset().left,y=l.find(".grsGallCoAlbPic").offset().top+(81-h)/2-p.offset().top}var I=p.find("img");n[u]=I.clone();var T=I.offset().left-p.offset().left,A=I.offset().top-p.offset().top;n[u].appendTo(p),n[u].attr("style","position: absolute;opacity: 0.3 !important;z-index: 100;width: "+I.width()+"px;height: "+I.height()+"px;left: "+T+"px;top: "+A+"px;"),n[u].animate({opacity:1,left:b,top:y,width:v,height:h},600,function(r){return function(){switch(grsAction){case"addImages":for(var e=0;e<g.items.length;e++)g.items[e].key==i[r]&&(g.items[e].hide=!1,g.$apply());break;case"addGPvIm":g.selGall.hidePvIm=!1,g.$apply();break;case"addPwAIm":g.grsSelectedAlbum.hidePvIm=!1,g.$apply()}}}(u)),function(e){setTimeout(function(){e.remove()},600)}(n[u])}var k={action:"grsGalleryAjax",grsAction:grsAction,grsId:grsId,files:e,types:r,orders:s,parentDirPath:x.parentDirPath,grsAjaxNonce:scriptData.grsAjaxNonce};a.grsLoading=!0,B({method:"POST",url:grsAdminAjax,data:jQuery.param(k),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){a.grsLoading=!1;var r=e.data;if("success"===Object.keys(r)[0]){switch(grsAction){case"addImages":a.grsMassage=x.getTrans("text_044"),g.addIdsToScopes(i,r.success);break;case"addGPvIm":x.options.addImage=!0,x.options.addImages=!0,x.options.addAction="addImages",x.options.addImageTitle="Add",a.grsMassage=x.getTrans("text_073");break;case"addPwAIm":a.grsMassage=x.getTrans("text_073")}a.grsMassageMood="success"}else a.grsMassage=r.error,a.grsMassageMood="error";a.massage()},function(e){return j.log("errr"),$q.reject(e)})}},x.getItemByKey=function(e){for(var r=0;r<x.items.length;r++)if(x.items[r].key==e)return x.items[r]},x.removeItemByKey=function(e){for(var r=0;r<x.items.length;r++)x.items[r].key==e&&x.items.splice(r,1);x.search()},x.changeItemsPerPage=function(){x.pageSize=void 0===x.pageSize||null==x.pageSize?1:x.pageSize,x.itemsPerPage=x.pageSize,x.search()};x.search=function(){x.filteredItems=r("filter")(x.items,function(e){for(var r in e)if("name"==r&&(o=e[r],!(r=x.query)||-1!==o.toLowerCase().indexOf(r.toLowerCase())))return!0;var o;return!1}),x.currentPage=0,x.groupToPages()},x.groupToPages=function(){x.pagedItems=[];for(var e=0;e<x.filteredItems.length;e++)e%x.itemsPerPage==0?x.pagedItems[Math.floor(e/x.itemsPerPage)]=[x.filteredItems[e]]:x.pagedItems[Math.floor(e/x.itemsPerPage)].push(x.filteredItems[e])},x.range=function(e,r){var o=[];r||(r=e,e=0);for(var t=e;t<r;t++)o.push(t);return o},x.prevPage=function(){0<x.currentPage&&x.currentPage--},x.nextPage=function(){x.currentPage<x.pagedItems.length-1&&x.currentPage++},x.lastPage=function(){x.currentPage<x.pagedItems.length-1&&(x.currentPage=x.pagedItems.length-1)},x.firstPage=function(){0<x.currentPage&&(x.currentPage=0)},x.setPage=function(){x.currentPage=this.n},x.getTrans=j.getTrans,s.find("#upload").fileupload({dropZone:jQuery("#drop"),submit:function(e,r){r.formData={action:"grsGalleryAjax",grsAction:"addImageToUploader",parentDirPath:x.parentDirPath,grsAjaxNonce:scriptData.grsAjaxNonce}},add:function(e,r){var o=x.itemsLength(),t=r.files[0].name,a=r.files[0].type,n=r.files[0].name.lastIndexOf(".");if("jpeg"===(a=a.split("/"))[1])var i=r.files[0].name.slice(0,n),a=(i=r.files[0].name.split(i))[1];else if("png"===a[1]){i=r.files[0].name.slice(0,n);a=(i=r.files[0].name.split(i))[1]}else{if("gif"!==a[1])return;i=r.files[0].name.slice(0,n);a=(i=r.files[0].name.split(i))[1]}t=t.slice(0,n),n=j.uploaderUrl+x.parentDirPath+"thumbnail/"+t+a;x.addItem(o,t,"",n,"",!1,a),x.$$phase||x.$apply();var s=jQuery("#grsImageKey"+o),o=new FileReader;o.onload=function(e){s.find(".grsGallUplImg").attr("src",e.target.result),s.find(".grsGallUplImgLdSC > input").knob(),s.find(".grsGallUplImgLdSC > input").css("display","inline-block;")},o.readAsDataURL(r.files[0]),r.context=s;r.submit()},start:function(e){jQuery(".grsGallUplProgress").css("display","block")},progress:function(e,r){var o=parseInt(r.loaded/r.total*100,10);r.context.find("input").val(o).change()},stop:function(e){jQuery(".grsGallUplProgress").hide(),jQuery(".grsGallUplProgress .grsGallUplProgressB").css("width",0)},progressall:function(e,r){r=parseInt(r.loaded/r.total*100,10)+"%";jQuery(".grsGallUplProgress .grsGallUplProgressB").css("width",r).text(r)},fail:function(e,r){r.context.addClass("error")},chunkfail:function(e,r){r.context.addClass("error")},done:function(e,r){var o=r.context.attr("id").split("grsImageKey"),t=Array.isArray(o)?o[1]:-1,a=JSON.parse(r.result),n=x.getItemByKey(t);if(0==a||void 0!==a.error){j.log(a);o=angular.element(jQuery(".grsGallHeader")).scope();return void 0!==a.error&&(o.grsMassage=a.error),0==a&&(o.grsMassage=x.getTrans("text_002")),o.grsMassageMood="error",o.massage(),r.context.addClass("grsUplError"),i(function(){x.removeItemByKey(t)},4500),void r.context.find(".grsGallUplImgLdC").addClass("grsDisplayNone")}void 0!==a.files&&(n.name=a.files[0].name.slice(0,-n.ext.length),n.path=j.uploaderUrl+x.parentDirPath+"thumbnail/"+n.name+n.ext),n.canAdd=!0,r.context.addClass("grsUplCompl"),r.context.find(".grsGallUplImgLdC").addClass("grsDisplayNone"),r.context.find(".grsGallUplImgAcC").removeClass("grsDisplayNone"),r.context.find("img").css("opacity",1),r.context.find("img").attr("src",n.path),x.$$phase||x.$apply()},always:function(e,r){},url:grsAdminAjax}),jQuery(document).on("drop dragover",function(e){e.preventDefault()})}}}]),grsApp.controller("grsGallHeader",["$scope","$filter","$log","$http","$timeout","$window","GrsAdminService",function(a,e,r,n,o,t,i){a.items=[],a.action="",a.selGall={},a.query="",a.activeTab="",a.showGTs=!1,a.upgradeUrl=i.upgradeUrl,a.grsLoading=!1,a.galleriesDataIsLoaded=!1,a.grsMassageC=!1,a.grsMassage="",a.grsMassageMood="",a.mTimeOut={},a.wmassage=function(){a.grsMassage=a.getTrans("text_003"),a.grsMassageMood="error",a.massage()},a.massage=function(e,r){a.grsMassageC=!0,e=!!angular.isUndefined(e)||e,r=angular.isUndefined(r)?3e3:r,angular.isUndefined(a.mTimeOut.cont)||o.cancel(a.mTimeOut.cont),angular.isUndefined(a.mTimeOut.text)||o.cancel(a.mTimeOut.text),e&&(a.mTimeOut.cont=o(function(){a.grsMassageC=!1},r),a.mTimeOut.text=o(function(){a.grsMassage=""},r+2e3)),a.$$phase||a.$apply()},a.pageination={items:[],currentPage:0,itemsPerPage:4},a.clearSearchBar=function(e){e.stopPropagation(),a.query="",a.pageination.search(a.query)},a.$watch("items",function(){switch(a.pageination.items=angular.copy(a.items),void 0!==a.pageination.search&&a.pageination.search(),a.action){case"addItem":a.pageination.firstPage(),a.selectGallery(0);break;case"deleteItem":angular.isUndefined(a.pageination.pagedItems[a.pageination.currentPage])&&a.pageination.currentPage--}a.action=""}),a.getItems=function(){var e={action:"grsGalleryAjax",grsAction:"getGalleryTItems",grsAjaxNonce:scriptData.grsAjaxNonce};a.grsLoading=!0,n({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){a.grsLoading=!1;e=e.data;void 0===e.error?a.items=e.success:(a.grsMassage=""!=e.error?e.error:a.getTrans("text_074"),a.grsMassageMood="error",a.massage())},function(e){return i.log("errr"),a.grsLoading=!1,a.grsMassage=a.getTrans("text_074"),a.grsMassageMood="error",a.massage(!1),$q.reject(e)})},a.getItems(),a.selectGallery=function(e,r){angular.isUndefined(r)||r.stopPropagation();var o=a.pageination.pagedItems[a.pageination.currentPage][e],r=o.id,e=angular.element(jQuery(".grsGallContent")).scope();r&&(a.selectTab("Gall"),void 0!==a.selGall.id&&a.selGall.id==r||(a.showGTs=!1,a.selGall=o,e.changeGallery(r),grsActiveCont="Gall"))},a.addItem=function(e,r,o){a.items.push({title:e,description:r,id:o}),a.action="addItem",a.items=angular.copy(a.items)},a.updateItem=function(e){a.selGall.title=e,i.log(a.selGall);for(var r=a.items,o=0;o<r.length;o++)r[o].id==a.selGall.id&&(r[o].title=e);a.action="updateItem",a.items=angular.copy(a.items)},a.deleteGalleryPr=function(e,r){angular.isUndefined(r)||r.stopPropagation();var o=angular.element(jQuery(".grsGallConfirmMC")).scope(),t=jQuery(r.target).offset().left-jQuery(".grsGallFCont").offset().left,r=jQuery(r.target).offset().top-jQuery(".grsGallFCont").offset().top;o.options.show=!0,o.options.left=t,o.options.top=25+r,o.options.grsConMess=a.getTrans("text_046"),o.options.grsConIt=a.pageination.pagedItems[a.pageination.currentPage][e].title,o.options.grsConTp=a.getTrans("text_075"),o.options.actCnt=".grsGallHeader",o.options.actF="deleteGallery",o.options.actP.push(e)},a.deleteGallery=function(e){var r=a.pageination.pagedItems[a.pageination.currentPage][e].id,o=a.pageination.itemsPerPage*a.pageination.currentPage+e,t=angular.element(jQuery(".grsGallContent")).scope(),e={action:"grsGalleryAjax",grsAction:"delete",grsGallid:r,grsAjaxNonce:scriptData.grsAjaxNonce};r&&(a.grsLoading=!0,n({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){i.log(e);e=e.data;void 0===e.error?(t.deleteGallery(r),a.action="deleteItem",a.items.splice(o,1),a.items=angular.copy(a.items),a.grsMassage=a.getTrans("successfully deleted"),a.grsMassageMood="success"):(a.grsMassage=e.error,a.grsMassageMood="error"),a.massage(),a.grsLoading=!1},function(e){return i.log("errr"),$q.reject(e)}))},a.addGallery=function(){var e=angular.element(jQuery(".grsGallContent")).scope();grsActiveCont="Gall",a.selectTab("Gall"),e.changeGallery(0),e.grsSave()},a.showGTsCont=function(e){if(e.preventDefault(),e.stopPropagation(),a.grsLoading||!a.galleriesDataIsLoaded)return a.grsMassage=a.getTrans("text_076"),a.grsMassageMood="success",void a.massage();e=a.items.length;0===e&&(a.grsMassage=a.getTrans("text_004"),a.grsMassageMood="success",a.massage()),a.showGTs=!(a.showGTs||0===e)},a.selectTab=function(e){var r=angular.element(jQuery(".grsGallContent")).scope(),o=angular.element(jQuery(".grsGallUpl")).scope();"Upl"!==e?(a.activeTab=e,grsActiveCont=e,r.show=!0,r.showContPart=e,o.activeTab(e)):o.options.show=!0},a.checkTooltip=function(){i.setTooltip()},a.$on("winclick::winclick",function(){a.showGTs&&(a.showGTs=!1,a.$$phase||a.$apply())}),a.getTrans=i.getTrans}]),grsApp.controller("grsConfirmM",["$scope","$filter","$log","$http","$timeout","GrsAdminService",function(o,e,r,t,a,n){o.options={show:!1,grsConMess:"",grsConIt:"",grsConTp:"",left:0,top:0,actCnt:"",actF:"",actP:[]},o.answer=function(e,r){r.stopPropagation(),e&&angular.element(jQuery(o.options.actCnt)).scope()[o.options.actF](o.options.actP[0]),o.options={show:!1,grsConMess:"",grsConIt:"",grsConTp:"",left:0,top:0,actCnt:"",actF:"",actP:[]},n.log(o.options)}}]);